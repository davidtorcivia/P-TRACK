{{ define "content" }}
<article class="card" style="margin-bottom: var(--space-6);">
    <hgroup>
        <h1>Reports & Analytics</h1>
        <p>View and export your injection and symptom data</p>
    </hgroup>
</article>

<div class="grid desktop-grid-cols-2" style="gap: var(--space-6); align-items: start;">
    <!-- Date Range Selection -->
    <article class="card" style="margin: 0;">
        <h3>Select Date Range</h3>
        <form x-data="{ startDate: '', endDate: '', courseId: '' }" style="margin-top: var(--space-4);">
            <label for="start-date">
                Start Date
                <input type="date" id="start-date" x-model="startDate" required>
            </label>

            <label for="end-date">
                End Date
                <input type="date" id="end-date" x-model="endDate" required>
            </label>

            <label for="course-filter">
                Course (optional)
                <select id="course-filter" x-model="courseId"
                        hx-get="/api/courses"
                        hx-trigger="load"
                        hx-swap="innerHTML">
                    <option value="">All Courses</option>
                </select>
            </label>

            <div class="grid desktop-grid-cols-2" style="gap: var(--space-4); margin-top: var(--space-4);">
                <button type="button"
                        @click="window.location.href = `/api/export/pdf?start_date=${startDate}&end_date=${endDate}&course_id=${courseId}`"
                        :disabled="!startDate || !endDate"
                        class="w-full">
                    Export PDF
                </button>
                <button type="button"
                        @click="window.location.href = `/api/export/csv?start_date=${startDate}&end_date=${endDate}&course_id=${courseId}`"
                        :disabled="!startDate || !endDate"
                        class="outline w-full">
                    Export CSV
                </button>
            </div>
        </form>
    </article>

    <!-- Quick Stats -->
    <article class="card" style="margin: 0;">
        <h3>Quick Statistics</h3>
        <div hx-get="/api/injections/stats"
             hx-trigger="load"
             hx-swap="innerHTML"
             style="margin-top: var(--space-4);">
            <p aria-busy="true">Loading stats...</p>
        </div>
    </article>
</div>

<!-- Charts Section -->
<article class="card" style="margin-top: var(--space-6);">
    <h3 style="margin-bottom: var(--space-4);">Data Visualization</h3>

    <div class="grid desktop-grid-cols-2" style="gap: var(--space-8);">
        <div>
            <h4 class="text-center text-secondary text-sm uppercase tracking-wide mb-4">Injection Frequency</h4>
            <canvas id="injection-frequency-chart"></canvas>
        </div>
        <div>
            <h4 class="text-center text-secondary text-sm uppercase tracking-wide mb-4">Pain Levels Over Time</h4>
            <canvas id="pain-trend-chart"></canvas>
        </div>
    </div>

    <div class="grid desktop-grid-cols-2" style="gap: var(--space-8); margin-top: var(--space-8);">
        <div>
            <h4 class="text-center text-secondary text-sm uppercase tracking-wide mb-4">Side Distribution</h4>
            <canvas id="side-distribution-chart"></canvas>
        </div>
        <div>
            <h4 class="text-center text-secondary text-sm uppercase tracking-wide mb-4">Symptom Frequency</h4>
            <canvas id="symptom-frequency-chart"></canvas>
        </div>
    </div>
</article>

<!-- Recent Activity Table -->
<article class="card" style="margin-top: var(--space-6);">
    <h3>Recent Injections</h3>
    <div hx-get="/api/injections/recent"
         hx-trigger="load"
         hx-swap="innerHTML"
         style="margin-top: var(--space-4);">
        <p aria-busy="true">Loading recent injections...</p>
    </div>
</article>

<script>
    // Initialize charts when page loads
    document.addEventListener('DOMContentLoaded', () => {
        // Placeholder charts - will be populated with real data via HTMX
        // Charts will be initialized after data is loaded
    });
</script>
{{ end }}
