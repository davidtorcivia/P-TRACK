{{ define "content" }}
{{ if .ActiveCourse }}
<div class="container">
    <!-- Quick Actions -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
        <a href="/injections" class="btn btn-secondary w-full">
            <span>ğŸ’‰</span>
            Log Injection
        </a>
        <a href="/symptoms" class="btn btn-secondary w-full">
            <span>ğŸ“</span>
            Log Symptoms
        </a>
        <a href="/medications" class="btn btn-secondary w-full">
            <span>ğŸ’Š</span>
            Log Medication
        </a>
    </div>

    <!-- Welcome Section -->
    <article>
        <header>
            <hgroup>
                <h1>Welcome back! ğŸ‘‹</h1>
                <p>Tracking progress for <strong>{{ .ActiveCourse.Name }}</strong>
                {{ if .LastInjection }}
                    â€¢ Last injection <strong>{{ .LastInjection.TimeAgo }}</strong>
                {{ end }}
            </p>
            </hgroup>
        </header>
    </article>

    <!-- Low Stock Alerts -->
    {{ if .LowStockItems }}
    <div class="message" style="background-color: var(--del-color-bg); border-color: var(--del-color-border);">
        <strong>âš ï¸ Low Stock Alerts</strong>
        <div class="grid">
            {{ range .LowStockItems }}
            <div>
                <strong>{{ .ItemType }}:</strong> {{ .Quantity }} {{ .Unit }} remaining
                {{ if .ExpirationDate }}
                â€¢ Expires {{ .ExpirationDate }}
                {{ end }}
            </div>
            {{ end }}
        </div>
        <footer>
            <a href="/inventory" class="btn btn-primary">ğŸ“¦ Manage Inventory</a>
        </footer>
    </div>
    {{ end }}

    <!-- Recent Activity -->
    <article>
        <header>
            <hgroup>
                <h3>Recent Activity</h3>
                <p>Your latest injections and logs</p>
            </hgroup>
        </header>
        <div id="recent-activity"
             hx-get="/api/dashboard/recent"
             hx-trigger="load"
             hx-swap="innerHTML">
            <div style="text-align: center; padding: 2rem;">
                <small>Loading recent activity...</small>
            </div>
        </div>
        <footer>
            <a href="/injections" class="btn btn-outline">ğŸ“‹ View All History</a>
        </footer>
    </article>

    <!-- Stats and Info Grid -->
    <div class="grid">
        <!-- Stats Column -->
        <div>
            <h2>Statistics</h2>

            <article>
                <header>
                    <h3>Total Injections</h3>
                </header>
                <p><strong>{{ .Stats.TotalInjections }}</strong></p>
                <div class="grid">
                    <small>L: {{ .Stats.LeftCount }}</small>
                    <small>R: {{ .Stats.RightCount }}</small>
                </div>
            </article>

            <article>
                <header>
                    <h3>Next Injection Site</h3>
                </header>
                <p><strong>{{ .Stats.NextInjectionSite }}</strong></p>
                <small>{{ .Stats.LastInjectionSide }} â†’ {{ .Stats.NextInjectionSite }}</small>
            </article>

            <article>
                <header>
                    <h3>Course Duration</h3>
                </header>
                <p><strong>{{ .Stats.CourseDays }}</strong> days active</p>
                <small>Since {{ .ActiveCourse.StartDate }}</small>
            </article>
        </div>

        <!-- Course Info Column -->
        <div>
            <h2>Course Information</h2>
            <article>
                <div>
                    <p><strong>Course Name:</strong> {{ .ActiveCourse.Name }}</p>
                    <p><strong>Start Date:</strong> {{ .ActiveCourse.StartDate }}</p>
                    {{ if .ActiveCourse.ExpectedEndDate }}
                    <p><strong>Expected End:</strong> {{ .ActiveCourse.ExpectedEndDate }}</p>
                    {{ end }}
                    {{ if .ActiveCourse.Notes }}
                    <p><strong>Notes:</strong> {{ .ActiveCourse.Notes }}</p>
                    {{ end }}
                </div>
                <footer>
                    <a href="/courses" class="btn btn-outline">ğŸ“‹ Manage Courses</a>
                </footer>
            </article>
        </div>
    </div>
</div>
{{ else }}
<!-- No Course State -->
<div class="container">
    <article style="text-align: center;">
        <header>
            <hgroup>
                <h1>Welcome to Injection Tracker! ğŸš€</h1>
                <p>Let's get started by creating your first treatment course.</p>
            </hgroup>
        </header>

        <div style="margin: 2rem 0;">
            <p>No active course. Create one to start tracking injections.</p>
        </div>

        <footer>
            <a href="/courses" class="btn btn-primary btn-xl">
                â• Create Your First Course
            </a>
        </footer>
    </article>

    <!-- Quick Links to show what's available -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="card">
            <div class="p-6 text-center">
                <div class="text-3xl mb-3">ğŸ’‰</div>
                <h3 class="text-lg font-semibold text-primary mb-2">Injections</h3>
                <p class="text-sm text-secondary">Log injection sites, pain levels, and notes with automatic rotation tracking</p>
            </div>
        </div>

        <div class="card">
            <div class="p-6 text-center">
                <div class="text-3xl mb-3">ğŸ“</div>
                <h3 class="text-lg font-semibold text-primary mb-2">Symptoms</h3>
                <p class="text-sm text-secondary">Track daily symptoms, pain levels, and side effects throughout your treatment</p>
            </div>
        </div>

        <div class="card">
            <div class="p-6 text-center">
                <div class="text-3xl mb-3">ğŸ’Š</div>
                <h3 class="text-lg font-semibold text-primary mb-2">Medications</h3>
                <p class="text-sm text-secondary">Manage medications with dosage tracking and adherence monitoring</p>
            </div>
        </div>

        <div class="card">
            <div class="p-6 text-center">
                <div class="text-3xl mb-3">ğŸ“¦</div>
                <h3 class="text-lg font-semibold text-primary mb-2">Inventory</h3>
                <p class="text-sm text-secondary">Monitor supplies and get alerts when stock is running low</p>
            </div>
        </div>
    </div>
</div>
{{ end }}
{{ end }}