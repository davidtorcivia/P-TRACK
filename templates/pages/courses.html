{{ define "content" }}
<hgroup>
    <h2>Treatment Courses</h2>
    <p>Manage your treatment cycles</p>
</hgroup>

<a href="#new-course" role="button">Create Course</a>

<!-- Active Course -->
{{ if .ActiveCourse }}
<article>
    <header>
        <hgroup>
            <h3>{{ .ActiveCourse.Name }}</h3>
            <p>Active Course</p>
        </hgroup>
    </header>
    <p><strong>Started:</strong> {{ .ActiveCourse.StartDate }}</p>
    {{ if .ActiveCourse.ExpectedEndDate }}
    <p><strong>Expected End:</strong> {{ .ActiveCourse.ExpectedEndDate }}</p>
    {{ end }}
    {{ if .ActiveCourse.Notes }}
    <p><strong>Notes:</strong> {{ .ActiveCourse.Notes }}</p>
    {{ end }}
    <footer>
        <div class="grid-2">
            <a href="#close-{{ .ActiveCourse.ID }}" role="button" class="outline">Close Course</a>
            <a href="#edit-{{ .ActiveCourse.ID }}" role="button" class="secondary">Edit</a>
        </div>
    </footer>
</article>
{{ end }}

<!-- Past Courses -->
{{ if .PastCourses }}
<h3>Past Courses</h3>
{{ range .PastCourses }}
<article>
    <hgroup>
        <h4>{{ .Name }}</h4>
        <p>Completed</p>
    </hgroup>
    <p>{{ .StartDate }} - {{ .EndDate }}</p>
    <footer>
        <div class="grid-3">
            <a href="#reactivate-{{ .ID }}" role="button" class="outline">Reactivate</a>
            <a href="#edit-{{ .ID }}" role="button" class="outline">Edit</a>
            <button onclick="if(confirm('Delete {{ .Name }}?')) {
                fetch('/api/courses/{{ .ID }}', {
                    method: 'DELETE',
                    headers: {'X-CSRF-Token': '{{ $.CSRFToken }}'}
                }).then(() => window.location.reload());
            }" class="outline">Delete</button>
        </div>
    </footer>
</article>
{{ end }}
{{ end }}

<!-- No Courses -->
{{ if not .ActiveCourse and not .PastCourses }}
<article style="text-align: center;">
    <hgroup>
        <h3>No Courses Yet</h3>
        <p>Create your first treatment course to start tracking</p>
    </hgroup>
    <a href="#new-course" role="button">Create Your First Course</a>
</article>
{{ end }}

<!-- New Course Modal -->
<dialog id="new-course">
    <article>
        <header>
            <button aria-label="Close" rel="prev"></button>
            <h3>Create New Course</h3>
        </header>
        <form method="dialog">
            <label>
                Course Name
                <input type="text" name="name" placeholder="e.g., IVF Cycle 1" required>
            </label>
            <div class="grid-2">
                <label>
                    Start Date
                    <input type="date" name="start_date" required>
                </label>
                <label>
                    Expected End Date
                    <input type="date" name="expected_end_date">
                </label>
            </div>
            <label>
                Notes
                <textarea name="notes" rows="2"></textarea>
            </label>
            <footer>
                <div class="grid-2">
                    <button type="button" class="secondary" onclick="this.closest('dialog').close()">Cancel</button>
                    <button type="submit">Create Course</button>
                </div>
            </footer>
        </form>
    </article>
</dialog>
{{ end }}
